{% extends "base.html" %}
{% block title %}Send Invitation{% endblock %}
{% block content %}
  <h1 align="center">Send Invitation</h1>
  <form method="POST">
    <div class="form-group">
      <label for="inputEmail">Email Address</label>
      <input type="email" class="form-control" id="inputEmail" name="email" placeholder="Enter email">
    </div>
    <button type="submit" class="btn btn-primary">Send Invitation</button>
  </form>

  <h1>Friends List</h1>
  <ul>
    {% if user.friends %}
      {% for friend in user.friends %}
        <li>{{ friend.email }}</li>
      {% endfor %}
    {% else %}
      <p>No friends yet.</p>
    {% endif %}
  </ul>

  <h1>Invitations</h1>
  <ul>
    {% if user.invitations %}
      {% for invite in user.invitations %}
        <li>{{ invite.email }}<button class="btn btn-success" onclick="acceptInvite('{{ invite.email }}')">Accept</button> <button class="btn btn-danger" onclick="rejectInvite('{{ invite.email }}')">Reject</button></li>
      {% endfor %}
    {% else %}
      <p>No invitations.</p>
    {% endif %}
  </ul>


  <script>
    function acceptInvite(email) {
        fetch("/accept-invite", {
            method: "POST",
            body: JSON.stringify({ inviter_email: email }),
        }).then((_res) => {
            window.location.reload();
        });
    }

    function rejectInvite(email) {
        fetch("/reject-invite", {
            method: "POST",
            body: JSON.stringify({ inviter_email: email }),
        }).then((_res) => {
            window.location.reload();
        });
    }
  </script>
{% endblock %}